<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="SV_UserGroupTagging" title="User Group Tagging" version_string="0.0.1" version_id="1" url="" install_callback_class="SV_UserGroupTagging_Listener" install_callback_method="install" uninstall_callback_class="SV_UserGroupTagging_Listener" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions>
    <admin_permission admin_permission_id="sv_ViewAllPrivateGroups" display_order="4000"/>
  </admin_permissions>
  <admin_style_properties/>
  <admin_templates>
    <template title="user_group_tagging"><![CDATA[<fieldset>
	<xen:checkboxunit label="" explain="{xen:phrase user_group_is_taggable_explain}">
		<xen:option name="sv_taggable" selected="{$userGroup.sv_taggable}">
			{xen:phrase user_group_is_taggable}
		</xen:option>
	</xen:checkboxunit>

	<xen:checkboxunit label="" explain="{xen:phrase user_group_is_private_explain}">
		<xen:option name="sv_private" selected="{$userGroup.sv_private}">
			{xen:phrase user_group_is_private}
		</xen:option>	
	</xen:checkboxunit>

	<xen:textboxunit label="{xen:phrase user_group_small_avatar}" name="sv_avatar_s" value="{$userGroup.sv_avatar_s}" >
		<xen:explain>{xen:phrase user_group_small_avatar_explain}</xen:explain>
	</xen:textboxunit>

	<xen:if is="{$userGroup.sv_avatar_s}">
		<img src="{$userGroup.sv_avatar_s}" class="" />
	</xen:if>

	<xen:textboxunit label="{xen:phrase user_group_large_avatar}" name="sv_avatar_l" value="{$userGroup.sv_avatar_l}" >
		<xen:explain>{xen:phrase user_group_large_avatar_explain}</xen:explain>
	</xen:textboxunit>

	<xen:if is="{$userGroup.sv_avatar_l}">
		<img src="{$userGroup.sv_avatar_l}" class="" />
	</xen:if>
</fieldset>]]></template>
  </admin_templates>
  <admin_template_modifications>
    <modification template="user_group_edit" modification_key="sv_ugt_user_group_edit" description="" execution_order="15" enabled="1" action="preg_replace">
      <find><![CDATA[#(\s*)(<fieldset id="piGroups">)#si]]></find>
      <replace><![CDATA[$1<xen:include template="user_group_tagging" />
$1$2]]></replace>
    </modification>
  </admin_template_modifications>
  <code_events/>
  <code_event_listeners>
    <listener event_id="init_dependencies" execute_order="10" callback_class="SV_UserGroupTagging_Listener" callback_method="init_dependencies" active="1" hint="" description="BodyText hook"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_Model_UserTagging" description="XenForo_Model_UserTagging"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerAdmin_UserGroup" description="XenForo_ControllerAdmin_UserGroup"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_Model_UserGroup" description="XenForo_Model_UserGroup"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Report" description="XenForo_Model_Report"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_Model_Post" description="XenForo_Model_Post"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_Model_ProfilePost" description="XenForo_Model_ProfilePost"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_DataWriter_UserGroup" description="XenForo_DataWriter_UserGroup"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_BbCode_Formatter_Base" description="XenForo_BbCode_Formatter_Base"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_BbCode_Formatter_Text" description="XenForo_BbCode_Formatter_Text"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_BbCode_Formatter_HtmlEmail" description="XenForo_BbCode_Formatter_HtmlEmail"/>
    <listener event_id="load_class" execute_order="1000" callback_class="SV_UserGroupTagging_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Member" description="XenForo_ControllerPublic_Member"/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups>
    <group group_id="SV_UserGroupTagging" display_order="132" debug_only="0"/>
    <option option_id="sv_ugt_email" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="SV_UserGroupTagging" display_order="100"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups/>
    <permissions>
      <permission permission_group_id="general" permission_id="sv_ReceiveTagAlertEmails" permission_type="flag" default_value="unset" interface_group_id="generalPermissions" display_order="11230"/>
      <permission permission_group_id="general" permission_id="sv_TagUserGroup" permission_type="flag" default_value="unset" interface_group_id="generalPermissions" display_order="11231"/>
    </permissions>
    <interface_groups/>
  </permissions>
  <phrases>
    <phrase title="admin_permission_sv_ViewAllPrivateGroups" version_id="1" version_string="0.0.1"><![CDATA[View All Private Groups]]></phrase>
    <phrase title="option_group_SV_UserGroupTagging" version_id="1" version_string="0.0.1"><![CDATA[User Group Tagging]]></phrase>
    <phrase title="option_group_SV_UserGroupTagging_description" version_id="1" version_string="0.0.1"><![CDATA[]]></phrase>
    <phrase title="option_sv_ugt_email" version_id="1" version_string="0.0.1"><![CDATA[Receive Tag Alert Emails]]></phrase>
    <phrase title="option_sv_ugt_email_explain" version_id="1" version_string="0.0.1"><![CDATA[Allows users to receive tag alert emails. Users still require opt-in under /account/contact-details.]]></phrase>
    <phrase title="permission_general_sv_ReceiveTagAlertEmails" version_id="1" version_string="0.0.1"><![CDATA[Receive Tag Alert Emails]]></phrase>
    <phrase title="permission_general_sv_TagUserGroup" version_id="1" version_string="0.0.1"><![CDATA[Tag User Group]]></phrase>
    <phrase title="sv_ugt_PrivateGroup" version_id="1" version_string="0.0.1"><![CDATA[Private Group]]></phrase>
    <phrase title="user_group_is_private" version_id="1" version_string="0.0.1"><![CDATA[Is Private]]></phrase>
    <phrase title="user_group_is_private_explain" version_id="1" version_string="0.0.1"><![CDATA[Only members of the group or administrators with the correct permission can view & tag this group]]></phrase>
    <phrase title="user_group_is_taggable" version_id="1" version_string="0.0.1"><![CDATA[Is Taggable]]></phrase>
    <phrase title="user_group_is_taggable_explain" version_id="1" version_string="0.0.1"><![CDATA[This group can be tagged. Warning: not recommended for large groups]]></phrase>
    <phrase title="user_group_large_avatar" version_id="1" version_string="0.0.1"><![CDATA[Large user group image]]></phrase>
    <phrase title="user_group_large_avatar_explain" version_id="1" version_string="0.0.1"><![CDATA[Image to use when displaying the user group membership list]]></phrase>
    <phrase title="user_group_small_avatar" version_id="1" version_string="0.0.1"><![CDATA[Small user group image]]></phrase>
    <phrase title="user_group_small_avatar_explain" version_id="1" version_string="0.0.1"><![CDATA[Image to use when displaying the user group during tagging.]]></phrase>
  </phrases>
  <route_prefixes/>
  <style_properties/>
  <templates>
    <template title="sv_members_usergroup" version_id="1" version_string="0.0.1"><![CDATA[<xen:require css="member_list.css" />
<xen:require css="UserGroupTagging.css" />
<xen:title>{$userGroup.username}</xen:title>
<div class="section">
	<div class="pairsJustified">
		<dl class="TaggedUserGroupHeader">
			<xen:if is="{$userGroup.avatar_l}">
				<dt>
					<img src="{$userGroup.avatar_l}" />
				</dt>
			</xen:if>
			<xen:if is="{$userGroup.private}">
				<dd>
					{xen:phrase sv_ugt_PrivateGroup}
				</dd>
			</xen:if>
		</dl> 
	</div>
	<ol class="memberList TaggedUserGroupMemberList">
		<xen:foreach loop="$users" value="$user">
			<xen:include template="member_list_item">
				<xen:set var="$noOverlay">1</xen:set>
			</xen:include>
		</xen:foreach>
	</ol>
</div>]]></template>
    <template title="UserGroupTagging.css" version_id="1" version_string="0.0.1"><![CDATA[.xenOverlay .TaggedUserGroupMemberList 
{ 
	max-height: 300px; overflow-y: scroll; 
}
]]></template>
  </templates>
  <public_template_modifications>
    <modification template="editor" modification_key="sv_usergrouptag_editor" description="" execution_order="10000" enabled="1" action="str_replace">
      <find><![CDATA[{xen:if $editorOptions.json, 'data-options="{xen:escape {xen:helper json, $editorOptions.json}}"'}]]></find>
      <replace><![CDATA[$0 data-ac-url="{xen:link members/group-find}"]]></replace>
    </modification>
    <modification template="member_view" modification_key="sv_usergrouptag_member_view" description="" execution_order="10000" enabled="1" action="preg_replace">
      <find><![CDATA[#class="[^"]*UserTagger[^"]*"#]]></find>
      <replace><![CDATA[$0 data-acurl="{xen:link members/group-find}"]]></replace>
    </modification>
    <modification template="navigation_visitor_tab" modification_key="sv_usergrouptag_navigation_visitor_tab" description="" execution_order="10000" enabled="1" action="preg_replace">
      <find><![CDATA[#class="[^"]*UserTagger[^"]*"#]]></find>
      <replace><![CDATA[$0 data-acurl="{xen:link members/group-find}"]]></replace>
    </modification>
    <modification template="profile_post" modification_key="sv_usergrouptag_profile_post" description="" execution_order="10000" enabled="1" action="preg_replace">
      <find><![CDATA[#class="[^"]*UserTagger[^"]*"#]]></find>
      <replace><![CDATA[$0 data-acurl="{xen:link members/group-find}"]]></replace>
    </modification>
    <modification template="report_view" modification_key="sv_usergrouptag_report_view" description="" execution_order="10000" enabled="1" action="preg_replace">
      <find><![CDATA[#class="[^"]*UserTagger[^"]*"#]]></find>
      <replace><![CDATA[$0 data-acurl="{xen:link members/group-find}"]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
